
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texto Colorido Dinâmico com Presets e Cores</title>
    <link rel="stylesheet" href="index.css">
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div class="main-container">
        <div class="control-group">
            <label for="gradient-type-selector">Tipo de Degradê:</label>
            <select id="gradient-type-selector">
                <option value="word" selected>Degradê por Palavra</option>
                <option value="sentence">Degradê na Frase</option>
                <option value="dark-light-dark-sentence">DLE - Frase Inteira</option>
                <option value="dark-light-dark-word">DLE - Por Palavra</option>
            </select>
        </div>

        <div class="control-group">
            <label for="gradient-base-color-picker">Cor Base do Gradiente (Escura):</label>
            <input type="color" id="gradient-base-color-picker">
        </div>

        <div class="control-group">
            <label for="gradient-lighten-color-picker">Cor de Clareamento do Gradiente:</label>
            <input type="color" id="gradient-lighten-color-picker">
        </div>

        <div class="colored-text-block">
            <!-- O conteúdo será inserido aqui pelo JavaScript -->
        </div>
    </div>

    <script>
        const myString = "Olha eu aqui denovo testando mais uma vez este efeito. Uma frase longa para testar os gradientes e as cores selecionáveis.";
        const textBlock = document.querySelector(".colored-text-block");
        const gradientSelector = document.getElementById("gradient-type-selector");
        
        const gradientBaseColorPicker = document.getElementById("gradient-base-color-picker");
        const gradientLightenColorPicker = document.getElementById("gradient-lighten-color-picker");

        function applyDarkLightDark(textUnit) {
            let unitHtml = "";
            const chars = Array.from(textUnit); 
            const len = chars.filter(char => char.trim() !== '').length; 
            let nonSpaceCharIndex = 0;

            if (len === 0) return textUnit; 

            for (let i = 0; i < chars.length; i++) {
                const char = chars[i];
                if (char.trim() === '') {
                    unitHtml += char; 
                    continue;
                }
                
                const posRatio = (len === 1) ? 0.5 : nonSpaceCharIndex / (len - 1);
                const distanceFromCenter = Math.abs(posRatio - 0.5); 

                let stepClass = 'dle-step-3'; 
                if (distanceFromCenter > 0.35) { 
                    stepClass = 'dle-step-1'; 
                } else if (distanceFromCenter > 0.15) {
                    stepClass = 'dle-step-2'; 
                }
                unitHtml += `<span class="${stepClass}">${char}</span>`;
                nonSpaceCharIndex++;
            }
            return unitHtml;
        }

        function renderColoredText() {
            if (!textBlock) {
                console.error("Elemento .colored-text-block não encontrado.");
                return;
            }

            const gradientType = gradientSelector.value;
            let htmlContent = "";
            const textToDisplay = myString.trim(); 

            textBlock.classList.remove(
                'word-gradient', 
                'sentence-gradient', 
                'dark-light-dark-sentence-gradient',
                'dark-light-dark-word-gradient'
            );

            if (gradientType === 'word') {
                textBlock.classList.add('word-gradient');
                const words = textToDisplay.split(/\s+/); 
                words.forEach(word => {
                    if (word.length > 0) {
                        htmlContent += '<span class="word">';
                        for (const char of word) {
                            htmlContent += `<span>${char}</span>`;
                        }
                        htmlContent += '</span> '; 
                    }
                });
            } else if (gradientType === 'sentence') {
                textBlock.classList.add('sentence-gradient');
                
                const nonSpaceChars = Array.from(textToDisplay).filter(char => char.trim() !== '');
                const totalNonSpaceChars = nonSpaceChars.length;
                if (totalNonSpaceChars === 0) {
                    textBlock.innerHTML = '';
                    return;
                }

                const segmentLength = Math.max(1, totalNonSpaceChars / 6);
                let nonSpaceCharCounter = 0;

                for (const char of textToDisplay) {
                    if (char.trim() !== '') {
                        const currentSegment = Math.floor(nonSpaceCharCounter / segmentLength);
                        const step = Math.min(6, currentSegment + 1);
                        htmlContent += `<span class="gradient-step-${step}">${char}</span>`;
                        nonSpaceCharCounter++;
                    } else {
                        htmlContent += char; 
                    }
                }
            } else if (gradientType === 'dark-light-dark-sentence') {
                textBlock.classList.add('dark-light-dark-sentence-gradient');
                htmlContent = applyDarkLightDark(textToDisplay);
            } else if (gradientType === 'dark-light-dark-word') {
                textBlock.classList.add('dark-light-dark-word-gradient');
                const words = textToDisplay.split(/\s+/);
                words.forEach(word => {
                    if (word.length > 0) {
                        htmlContent += `<span class="word">${applyDarkLightDark(word)}</span> `;
                    }
                });
            }
            textBlock.innerHTML = htmlContent.trimEnd(); 
        }

        function initializeColorPickers() {
            const rootStyle = getComputedStyle(document.documentElement);
            
            const initialGradientBaseColor = rootStyle.getPropertyValue('--primary-gradient-base-color-light').trim();
            if (initialGradientBaseColor) gradientBaseColorPicker.value = initialGradientBaseColor;

            const initialGradientLightenColor = rootStyle.getPropertyValue('--gradient-lighten-color').trim();
            if (initialGradientLightenColor) gradientLightenColorPicker.value = initialGradientLightenColor;
            else gradientLightenColorPicker.value = "#ffffff"; 
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            initializeColorPickers();
            renderColoredText(); 
        });

        gradientSelector.addEventListener('change', renderColoredText); 

        gradientBaseColorPicker.addEventListener('input', (event) => {
            document.documentElement.style.setProperty('--primary-gradient-base-color-light', event.target.value);
            // Atualiza a cor do texto do seletor de tipo de degradê, que usa esta variável
            gradientSelector.style.color = event.target.value;
        });

        gradientLightenColorPicker.addEventListener('input', (event) => {
            document.documentElement.style.setProperty('--gradient-lighten-color', event.target.value);
        });

    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>